# Introduction
This page assumes an understanding of the idea behind these prototypes: see `/documentation/depth_design.md`. For technical details, see `/documentation/depth_technical.md`. All code is found in the folder `/depth_map_designs/`.

There are three prototypes in this group: duration (`duration.js`), echo (`echo.js`), and multiple echo (`OLD_echo_multiple.js`). See `guide.md` for descriptions. 

If you want to take a look at this idea, **I recommend either duration or echo** (`duration.js`|`echo.js`, `depth.html`). They are extremely similar, and both fully functional.

The multiple-echo prototype (`OLD_echo_multiple.js`, `depth.html`) was the earliest --- and thus worst --- version of the "multiple tones to communicate depth" idea. It was also very much a first draft, so some of the code --- especially use of Tone.js --- is not good. Breaking changes were made since I stopped working on it. It's there, but I do not recommend trying to check it out unless you're picking up this project and want to understand the full design iteration.

# Opening the prototype UI --- HTML

Set up a localhost (I used the VSCode LiveServer extension) to view the HTML page for the prototype.

There is **one html page for all prototypes** in this group: `/depth_map_designs/depth.html`. By default, it is linked to `duration.js`, as the most recent prototype. If you wish to see/use the single-echo prototype, swap which `<script>` tag is commented out:
```
 <!--UNCOMMENT LINE BELOW TO USE THE "ECHO" (single-echo) PROTOTYPE: -->
 <!-- <script type="module" src="echo.js"></script> -->
 <!--UNCOMMENT LINE BELOW TO USE THE "DURATION" PROTOTYPE - default: -->
 <script type="module" src="duration.js"></script>
```

To see the multiple-echo prototype, comment out both of those imports and add the following (just underneath, still inside the `<head>`):
```
<script type="module" src="OLD_echo_multiple.js"></script>
```

# Default Controls
In all cases, the playback is started by hitting the play/pause key on the keyboard. **By default, this is the spacebar**.

In echo and duration prototypes, hitting it again will pause playback.

NOTE: I noticed a bug at one point that repeatedly pausing/unpausing playback caused the tones to rapidly become louder, until it was uncomfortable and the sound was clipping. I have not had a chance to look into this, but if that's happening, just reload the page to reset.

As with the interactive scan prototypes, **there is no button** in the UI to play/pause.

**IMPORTANT**: You must have "selected" / "focused on" the page in order for the keybinds to work.
	e.g. if you opened the console and have selected it so your cursor is flashing in the console, spacebar will type a space character in there instead of starting the sonfication. Click anywhere on the webpage to refocus on it.


# Changing settings

## Global variables
Some settings can be easily configured by **changing the values of the global variables at the top of the JS file** for the prototype you're looking at. Unless otherwise specified, these variables exist in all prototypes of this group.

### Changing the keybinds
To change the keybind for play/pause, change the value of `TOGGLE_PLAY` (should be the first variable). Set `TOGGLE_PLAY`  to the **name string ("value") of the desired key in the Keyboard Events API**. Here is a [list of key values](https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values#navigation_keys) and a [list of code values](https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_code_values) in the API --- the latter may be easier to search through.

NOTE: the name of the spacebar is just the space character (`" "`). This is the default value for all prototypes.

### Tone spacing
`TONE_SPACING` is the number of seconds between the end of one full object tone (e.g. primary tone + secondary/echo tone in `echo.js`) and the start of the next. It can be a decimal.

In multiple-echoes, since the echoes are generated by delay effects on the primary tone instead of separate objects (see: `./depth_technical.md`), `TONE_SPACING` is the number of seconds between the *start* of one tone and the start of the next.
*I wasn't kidding, this one isn't very good.*

### Secondary tone duration
In echo and duration prototypes, `SECONDARY_DURATION` is the duration in seconds of the secondary tone. Default is different between prototypes, b/c the secondary tone is accomplishing a different function.

### Changing the source image
In echo and duration prototypes, `schema_url` is the path/url to the JSON file with the picture data. See `./depth_technical.md` for more details on that.

If you want to test these prototypes on a different picture, create a JSON file for it using the schema at `/documentation/EDITED_object_detection_schema.json` and set `schema_url` to that file.

### Changing base tones
1. Import the new file(s) to `/depth_map_designs/audio_tracks/`.
2. To change the primary tone, set `D_URL` to that filepath (named because the note I set it to in the `Sampler`s is D1).
3. To change the secondary tone in duration prototype, set `SECONDARY_URL` to that filepath.

## Changing effect parameters
**This applies only to echo and duration prototypes** --- *not* multiple-echo.

There is a "TONE SETUP FUNCTIONS" section, indicated by comments: in there, are several functions called `normalize_<effect>()`. See `./depth_technical.md` for more details, but they generally just remap the [0,1] depth value range from the schema to a new range specific to that effect, and the new maximum and minimum are variables in the function. **Change the values of those variables to change the range of possible degree for that effect** (e.g. range of seconds for the duration of the main tone, range of "wetness" of reverb on echo). The relative values for tones within the sonification will be preserved.
